# 认证
我们已经介绍过认证流程，因此在这里，我们需要完成本项目的认证设计。

> 本项目不考虑授权协议，如果需要授权，可以使用 **OAuth 2.0**。

## 技术选择
我们需要一个认证协议，然后需要授权完成后以Token的形式将凭据给用户。

一般认证协议分为几种，例如最简单的`密码Hash`，现代的`aPAKE协议`和`IdP协议`。

**密码Hash** 易受到撞库和彩虹表攻击，**IdP协议** 搭建过于麻烦（因为其不是基于密码），需要搭建其他基础设施。因此我们可以选择高安全性的aPAKE协议。

### [OPAQUE协议](opaque.md)

作为aPAKE的一种实现，OPAQUE具有极高的安全性。其优点是无需向服务器透露密码本身，也能实现安全的认证。并且基于双盲设计，可以有效防止离线攻击。

> **参见：**[OPAQUE协议](opaque.md)

### 令牌
个人不太喜欢JWT的token，不仅长，并且作为Stateless的token，一经授权无法撤销。所以直接用Opaque Token来实现了。

### 双令牌认证
一般我们会使用双令牌认证，即`Access Token`和`Refresh Token`，`Access Token`用于访问API，有效期较短；`Refresh Token`仅用于刷新`Access Token`，有效期较长。这样的设计在`Access Token`泄露时，可以尽量减少攻击窗口。`Refresh Token`可以方便地吊销，并且其刷新对于用户是无感的。